# 安全
## 安全基础知识
当通过互联网交换数据时，数据通过各种网络和设备到达另一方。
因此，为了安全使用互联网，安全技术是不可缺的。
首先，我们来看看在互联网上交换数据时可能出现的四个代表性问题。
1. A -> information -> B，这个过程中 information 可能遭到窃听，这个问题被称为窃听
2. 本身意图: A -> information -> B，但是 X 可能假扮 A 或者 B，这个问题被称为欺骗
3. A -> information -> B，在传输过程中，information 可能被 X 重写，这个问题被称为伪造，除了伪造以外，接受的数据也可能由于通信故障损坏
4. A -> information -> B，但是 A 恶意，坚持说 B 收到的信息不是 A 发出来的，如果发生这种情况，互联网上的商业交易和合同将不会成立，这个问题被称为否认

再来回顾以下四个问题：窃听，欺骗，伪造，否认。
为了解决窃听问题，我们使用加密
为了防止欺骗，我们使用消息认证码或者数字签名技术
为了防止伪造，我们使用消息认证码或者数字签名技术
为了防止否认，我们使用数字签名技术
|问题|解决|
|-|-|
|窃听|加密|
|欺骗|消息认证码或者数字签名|
|伪造|消息认证码或者数字签名|
|否认|数字签名|
还有一种称为数字证书的技术，以解决数字签名技术中存在的公钥持有人无法识别这一问题。
## 加密基础知识
A -> information -> B，如果发送原文，数据可能被有恶意的第三者看到，因此需要加密并发送要保密的数据。
A - information - ?info -> B，其中 ?info 表示被加密的数据。
## 共有密钥加密
共有密钥加密是使用相同密钥进行加密和揭秘的加密方法。例如：
- 凯撒密码
- AES(Advanced Encryption Standard)
- DES(Data Encryption Standard)

但是，共有密钥加密需要一种方式来安全的传输密钥，这被称为钥匙交互问题。这个问题有两种解决方案：
1. 使用密钥交换协议的方法
2. 使用公开密钥加密的方法

## 公开密钥加密
公开密钥加密是一种使用不同密钥进行加密和解密的加密方法，用于加密的密钥称为公开密钥，用于解密的密钥称为秘密密钥。与共有密钥加密相比，空开密钥加密往往需要更多的时间用于加密和解密。公开密钥加密计算方法的例子：
1. RSA 加密算法
2. 椭圆曲线密码学

A -> information -> B，首先 B 创建一个公开密钥和一个秘密密钥，公开密钥被发送给 A 方，A 使用公开密钥对数据进行加密，密文发送给 B 方，B 方使用秘密密钥并解密从 A 方收到的密文。由于公开密钥不能用于解密，所以密钥传输问题不会发生在公开密钥加密中。

但是，公开密钥加密存在两个问题：
1. 加密和解密需要时间，不适合来回交换少量数据。作为这个问题的解决方案，有一个叫“混合加密”的方法
2. 公开密钥的可靠性。由于公开密钥本身不能指示谁创建了它，所以如果第三者 X 恶意替换了公开密钥为自己的密钥 Px，A 使用 Px 对数据加密，X 截取了数据数据并进行解密，得到原文 abc，之后再用 Pb 进行加密，发送给 B。这种通过替换公开密钥而被窃取数据的攻击方法被称为中间人攻击。问题根源在于 A 方无法确认他们收到的公开密钥是不是由 B 创建。为了解决这个问题，使用了数字证书系统

## 混合加密
使用公有密钥加密方法有如何安全交换密钥的密钥运输问题。另一方面，在公开密钥加密方法中，存在加密和解密期间处理缓慢的问题。混合加密将两者结合起来，使用公开密钥加密传输公有密钥，之后的传输都使用公有密钥。这样，混合加密将安全性和快速处理都结合起来了。它是一种用于在互联网上安全地交换信息，用于“SSL”的一种生活上不可或缺的加密方法。

## 迪菲-赫尔曼密钥交换
是一种在两方之间安全交换密钥的方法。假设有一种特殊的组合方法来组合两个密钥，用这种方法，当密钥 P 和 S 被组合时，产生新的密钥 PS，这个方法有两个特点：
1. 拥有 PS 和 P，无法解构出 S，拥有 PS 和 S，无法解构出 P
2. P 和 PS 可以结合为 PPS，换句话说，任何合成的密钥可以进一步组合
   
A -> P -> B
A SA + P = PSA
B SB + P = PSB
A -> PSA -> B
A <- PSB <- B
A SA + PSB = PSASB
B SB + PSA = PSASB
中间人最多截获 P, PSA, PSB，但是无法组合成 PSASB

## 讯息鉴别码
加密之后虽然信息无法被窃听，但是还是可以被伪造。为了检测伪造，超出加密的额外措施是必要的。MAC 信息鉴别码。（密文 + 密钥） - hash -> mac，把密文和 mac 一起发给 B，如果这个过程被截获并伪造，mac 会变的，B 会检查出来，由于中间人没有密钥，所以没有办法伪造 mac。

但是 A 和 B 都能创建密文 + mac，所以 A 如果有恶意，并且坚持信息不是自己发的，是 B 伪造的，那就很尴尬了。为了防止事后否认，有必要使用数字签名。

## 数字签名
使用私钥加密，就能得到签名。因为公钥解密，所以接收方可以验证发送者，但是接收方不能伪造发送者，因为没有私钥。

## 数字证书
公开密钥加密和数字签名系统存在不能保证公开密钥属于谁的问题，因此当 A 试图想公开密钥发送给 B 的时候，第三方可能会在收件人不知道的情况下交出了被替换的公开密钥。

通过使用数字证书系统，我们可以保证谁是公开密钥的创建者。A 通过把公开密钥 PA 和个人信息发送给认证机构，认证机构使用自己的私钥给 PA 和 A 的个人信息创建数字签名，PA 和 A 的个人信息和签名该文件成为 A 的数字证书。A 将数字证书发给 B，B 使用机构的公开密钥对数字签名进行验证，如果验证结果没有问题，说明数字证书是由机构签发的。